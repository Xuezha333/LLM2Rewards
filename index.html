<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LLM Boost</title>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="./static/css/academicons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>

<body>


    <section class="hero">
        <div class="hero-body">
            <div class="container is-max-desktop">
                <div class="columns is-centered">
                    <div class="column has-text-centered">
                        <h1 class="title is-1 publication-title">Boosting Universal LLM Reward Design through Heuristic Reward Observation Space Evolution</h1>
                     
                    <div class="is-size-5 publication-authors">
                        <span class="author-block">
                            <a target="_blank" href="">
                                Zen Kit&#160;Heng</a>
                                <sup>1&dagger;</sup>,
                            <a target="_blank"
                                href="https://tneitap.github.io/">Zimeng&#160;Zhao</a><sup>2&dagger;</sup>,

                            <a target="_blank" href="https://tianhaowuhz.github.io/">Tianhao&#160;Wu</a><sup>1&#8225</sup>,
                            <a target="_blank"
                                href="https://yuanfei-wang.github.io/">Yuanfei&#160;Wang</a><sup>1&#8225</sup>,
                            <br>
                            <a target="_blank"
                                href="https://aaronanima.github.io/">Mingdong&#160;Wu</a><sup>1</sup>,
                            <a target="_blank"
                                href="">Yangang&#160;Wang</a><sup>2</sup>,
                            <a target="_blank" href="https://zsdonghao.github.io/">Hao&#160;Dong</a>
                            <a href="mailto:hao.dong@pku.edu.cn">
                                <span class="icon">
                                    <i class="fa fa-envelope"></i>
                                </span>
                            </a>
                            <sup>1</sup>,
                        </span>
                    </div>

    

                        <div class="is-size-5 publication-authors">
                            <span class="author-block"><sup>1</sup>Peking University; </span>
                            <span class="author-block"><sup>2</sup>Southeast University; </span>
                            <span class="author-block"><sup>&dagger;</sup>Equal Contribution; </span>
                            <span class="author-block"><sup>â€¡</sup>Equal Contribution </span>
                        </div>
                        <div class="is-size-5 publication-authors">

                        <span class="author-block">
                                    <span class="icon">
                                        <i class="fa fa-envelope"></i>
                                    </span>
                            Corresponding to hao.dong@pku.edu.cn
                        </span>
                        </div>
                        <!-- <div class="is-size-5 publication-authors">
                        <span class="author-block">Work done during the first author's internship at NVIDIA</span>
                        </div> -->

                        <!-- <div class="is-size-5 publication-authors">
                        <span class="author-block"><sup>&dagger;</sup>Equal Contribution</span>
                        <span class="author-block"><sup>&#8225;</sup>Equal Advising </span>
                    </div> -->

                        <div class="column has-text-centered">
                            <div class="publication-links">
                                <!-- TODO REPLACE ALL LINKS -->
                                <span class="link-block">
                                    <a target="_blank" href=""
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="ai ai-arxiv"></i>
                                        </span>
                                        <span>arXiv (Comming Soon)</span>
                                    </a>
                                </span>

                                <span class="link-block">
                                    <a target="_blank" href="assets/Boosting_Universal_LLM_Reward_Design_through_Heuristic_Reward_Observation_Space_Evolution.pdf"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fas fa-file-pdf"></i>
                                        </span>
                                        <span>PDF</span>
                                    </a>
                                    <a target="_blank" href=""
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fab fa-github"></i>
                                        </span>
                                        <span>Code (Comming Soon)</span>
                                    </a>
                                    <!-- <a target="_blank" href="https://github.com/vimalabs/VIMA#pretrained-models"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fa fa-network-wired"></i>
                                        </span>
                                        <span>Models</span>
                                    </a> -->
                                    <!-- <a target="_blank" href="https://github.com/vimalabs/VimaBench"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fas fa-robot"></i>
                                        </span>
                                        <span>Benchmark</span>
                                    </a> -->
                                    <!-- <a target="_blank" href="https://huggingface.co/datasets/VIMA/VIMA-Data"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fas fa-database"></i>
                                        </span>
                                        <span>Dataset</span>
                                    </a> -->
                                </span>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section" style="padding: 0">
        <div class="container is-max-desktop">
            <!-- Abstract. -->
            <div class="columns is-centered has-text-centered">
                <video poster="" id="" autoplay controls muted loop width="100%" playbackRate=2.0 style="border-radius: 5px;">
                    <source src="videos/intro_video.mp4" type="video/mp4">
                </video>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">
            <!-- Abstract. -->
            <div class="columns is-centered has-text-centered">
                <div class="column">
                    <h2 class="title is-3">Abstract</h2>
                    <div class="content has-text-justified">
                        <p style="font-size: 125%">
                            Large Language Models (LLMs) are emerging as promising tools for automated reinforcement learning (RL) reward design, owing to their robust capabilities in commonsense reasoning and code generation. By engaging in dialogues with RL agents, LLMs construct a Reward Observation Space (ROS) by selecting relevant environment states and defining their internal operations. However, existing frameworks have not effectively leveraged historical exploration data or manual task descriptions to iteratively evolve this space. In this paper, we propose a novel heuristic framework that enhances LLM-driven reward design by evolving the ROS through a table-based exploration caching mechanism and a text-code reconciliation strategy. Our framework introduces a state execution table, which tracks the historical usage and success rates of environment states, overcoming the Markovian constraint typically found in LLM dialogues and facilitating more effective exploration. Furthermore, we reconcile user-provided task descriptions with expert-defined success criteria using structured prompts, ensuring alignment in reward design objectives. Comprehensive evaluations on benchmark RL tasks demonstrate the effectiveness and stability of the proposed framework.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-widescreen">
            <div class="rows">
                <div class="rows is-centered ">
                    <div class="row is-full-width">
                        <h2 class="title is-3"><span class="dvima">Our Rewards and Policies</span></h2>
                        <p style="font-size: 125%">
                            In this demo, we visualize our unmodified best reward
                            for each environment and the policy trained using this reward. Our environment suite spans 20 distinct tasks across the Bidexterous Manipulation (Dexterity) benchmark.
                        </p>
                    </div>
                </div>
            </div>
            <br>
            <div class="columns" style="align-items: end;">
                <div class="column is-half">
                    <p style="font-size: 1.5em"><b>Dexterity</b></p>
                    <div class="col-md-4 col-sm-4 col-xs-4">
                        <img src="videos/task_ours/BlockStack.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandBlockStack</b>, Our best reward:
                        [sep]
                        assets/reward_functions/BlockStack.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/BottleCap.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandBottleCap</b>, Our best reward:
                        [sep]
                        assets/reward_functions/BottleCap.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/CatchAbreast.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandCatchAbreast</b>, Our best reward:
                        [sep]
                        assets/reward_functions/CatchAbreast.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/CatchOver2Underarm.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandCatchOver2Underarm</b>, Our best reward:
                        [sep]
                        assets/reward_functions/CatchOver2Underarm.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/CatchUnderarm.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandCatchUnderarm</b>, Our best reward:
                        [sep]
                        assets/reward_functions/CatchUnderarm.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/DoorCloseInward.png" width="18%" style="border-radius: 5px;"
                            alt='<b>ShadowHandDoorCloseInward</b>, Our best reward:
                        [sep]
                        assets/reward_functions/DoorCloseInward.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/DoorCloseOutward.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandDoorCloseOutward</b>, Our best reward:
                        [sep]
                        assets/reward_functions/DoorCloseOutward.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/DoorOpenInward.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandDoorOpenInward</b>, Our best reward:
                        [sep]
                        assets/reward_functions/DoorOpenInward.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/DoorOpenOutward.png" width="18%" style="border-radius: 5px;"
                            alt='<b>ShadowHandDoorOpenOutward</b>, Our best reward:
                        [sep]
                        assets/reward_functions/DoorOpenOutward.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/GraspAndPlace.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandGraspAndPlace</b>, Our best reward:
                        [sep]
                        assets/reward_functions/GraspAndPlace.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/Kettle.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandKettle</b>, Our best reward:
                        [sep]
                        assets/reward_functions/Kettle.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/LiftUnderarm.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandLiftUnderarm</b>, Our best reward:
                        [sep]
                        assets/reward_functions/LiftUnderarm.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/Over.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandOver</b>, Our best reward:
                        [sep]
                        assets/reward_functions/Over.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/Pen.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandPen</b>, Our best reward:
                        [sep]
                        assets/reward_functions/Pen.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/PushBlock.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandPushBlock</b>, Our best reward:
                        [sep]
                        assets/reward_functions/PushBlock.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/ReOrientation.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandReorientation</b>, Our best reward:
                        [sep]
                        assets/reward_functions/ReOrientation.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/Scissors.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandScissors</b>, Our best reward:
                        [sep]
                        assets/reward_functions/Scissors.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/SwingCup.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandSwingCup</b>, Our best reward:
                        [sep]
                        assets/reward_functions/SwingCup.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/Switch.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandSwitch</b>, Our best reward:
                        [sep]
                        assets/reward_functions/Switch.txt' onclick="populateDemo(this, 1);">

                        <img src="videos/task_ours/TwoCatchUnderarm.png" width="18%" style="border-radius: 5px;" alt='<b>ShadowHandTwoCatchUnderarm</b>, Our best reward:
                        [sep]
                        assets/reward_functions/TwoCatchUnderarm.txt' onclick="populateDemo(this, 1);">
                    </div>
                </div>
                <div class="row border rounded" style="padding-top:12px; padding-bottom:12px;">
                    <div class="col-md-6">
                        <video id="demo-video-1" style="border-radius: 5px;" autoplay loop muted webkit-playsinline
                            playsinline onclick="setAttribute('controls', 'true');">
                            <source id="expandedImg-1" src="videos/placeholder.mp4" type="video/mp4">
                        </video>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div id="imgtext-1" style="font-size: 1.5em">Select an image above:</div>
                <div>
                    <pre
                        class="p-1"><code class="language-python" id="answer-1">Eureka response shown within code block.</code></pre>
                </div>
            </div>
        </div>
    </section>

    <section class="section"></section>
        <div class="container is-max-widescreen">
            <div class="rows">
                <div class="rows is-centered ">
                    <div class="row is-full-width">
                        <h2 class="title is-3"><span class="dvima">Our Components</span></h2>

                        <!-- <img src="assets/images/eureka.png" class="interpolation-image" alt=""
                            style="display: block; margin-left: auto; margin-right: auto" />
                        <br> -->
                        <div class="columns is-centered has-text-centered">
                            <img src="assets/images/Components.png" alt="Eureka Video Thumbnail" width="90%" style="border-radius: 5px;">
                        <!-- <video poster="" id="" autoplay controls muted width="90%" playbackRate=2.0 style="border-radius: 5px;">
                            <source src="assets/images/eureka.mp4" type="video/mp4">
                        </video> -->
                        </div>
                        <span style="font-size: 125%">Components video<b> Comming SOON</b></span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section"></section>
        <div class="container is-max-widescreen">
            <div class="rows">
                <div class="rows is-centered ">
                    <div class="row is-full-width">
                        <h2 class="title is-3"><span class="dvima">Experiments</span></h2>

                        <!-- <img src="assets/images/eureka.png" class="interpolation-image" alt=""
                            style="display: block; margin-left: auto; margin-right: auto" />
                        <br> -->
                        <div class="columns is-centered has-text-centered">
                            <img src="assets/images/Ours_Experiments.png" alt="Eureka Video Thumbnail" width="90%" style="border-radius: 5px;">
                        <!-- <video poster="" id="" autoplay controls muted width="90%" playbackRate=2.0 style="border-radius: 5px;">
                            <source src="assets/images/eureka.mp4" type="video/mp4">
                        </video> -->
                        </div>
                        <span style="font-size: 125%">Experiments descriptions<b> Comming SOON</b></span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section"></section>
        <div class="container is-max-widescreen">
            <div class="rows">
                <div class="rows is-centered ">
                    <div class="row is-full-width">
                        <h2 class="title is-3"><span class="dvima">Ablation</span></h2>
                        <img src="assets/images/Ours_Ablation.png" class="interpolation-image" alt=""
                            style="display: block; width: 100%; margin-left: auto; margin-right: auto" />
                        <br>
                        <span style="font-size: 125%">Ablation Descriptions <b>Comming SOON</b> 
                        </span>
                        <br>
                        <br>
                        <br>
                        <br>
                        <h3 class="title is-4"><span class="dvima">Threshold settings</span></h3>
                        <div class="columns">
                            <div class="column has-text-centered">
                                <video poster="" id="" autoplay controls muted loop height="100%" playbackRate=2.0 style="border-radius: 5px;">
                                    <source src="videos/task_ours/DoorCloseOutwardAblation.mp4" type="video/mp4">
                                </video>
                                <p style="font-size: 110%">ShadowHandDoorCloseOutward (sr=1.00)</p>
                            </div>
                            <div class="column has-text-centered">
                                <video poster="" id="" autoplay controls muted loop height="100%" playbackRate=2.0 style="border-radius: 5px;">
                                    <source src="videos/task_ours/CatchAbreastAblation.mp4" type="video/mp4">
                                </video>
                                <p style="font-size: 110%">ShadowHandCatchAbreast (sr=0.54)</p>
                            </div>
                        </div>
                        <span style="font-size: 125%">
                            <span style="font-weight: bold"></span> Ablation descriptions <b>Comming SOON</b>
                        </span>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                    </div>
                </div>
            </div>
        </div>
    </section>


<section class="section" id="BibTeX">
    <div class="container is-max-widescreen content">
        <h2 class="title">BibTeX</h2>
        <pre><code>@article{ma2024xxxxx,
    title   = {Boosting Universal LLM Reward Design through Heuristic Reward Observation Space Evolution},
    author  = {Zen Kit Heng and Zimeng Zhao and Tianhao Wu and Yuanfei Wang and Mingdong Wu and Yangang Wang and Hao Dong},
    year    = {2024},
    journal = {arXiv preprint arXiv: Comming Soon}
}
</code></pre>
    </div>
</section>

    <footer class="footer">
        <div class="container">
            <div class="columns is-centered">
                <div class="column">
                    <div class="content has-text-centered">
                        <p>
                            Website template borrowed from 
                            <a
                                href="https://eureka-research.github.io/">Eureka</a>,
                            <a
                                href="https://github.com/nerfies/nerfies.github.io">NeRFies</a>,
                            <a href="https://vimalabs.github.io/">VIMA</a>, and <a
                                href="https://language-to-reward.github.io/">L2R</a>.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

</body>

<script>

    timeoutIds = [];

    function populateDemo(imgs, num) {
        // Get the expanded image
        var expandImg = document.getElementById("expandedImg-" + num);
        // Get the image text
        var imgText = document.getElementById("imgtext-" + num);
        var answer = document.getElementById("answer-" + num);

        // Use the same src in the expanded image as the image being clicked on from the grid
        expandImg.src = imgs.src.replace(".png", ".mp4");
        var video = document.getElementById('demo-video-' + num);
        // or video = $('.video-selector')[0];
        video.pause()
        video.load();
        video.play();
        video.removeAttribute('controls');

        console.log(expandImg.src);
        // Use the value of the alt attribute of the clickable image as text inside the expanded image
        var qa = imgs.alt.split("[sep]");
        imgText.innerHTML = qa[0];
        answer.innerHTML = "";
        // Show the container element (hidden with CSS)
        expandImg.parentElement.style.display = "block";
        for (timeoutId of timeoutIds) {
            clearTimeout(timeoutId);
        }

        // NOTE (wliang): Modified from original to read from file instead
        fetch(qa[1])
            .then(response => response.text())
            .then(contents => {
                // Call the processData function and pass the contents as an argument
                typeWriter(contents, 0, qa[0], num);
            })
            .catch(error => console.error('Error reading file:', error));
    }

    function typeWriter(txt, i, q, num) {
        var imgText = document.getElementById("imgtext-" + num);
        var answer = document.getElementById("answer-" + num);
        if (imgText.innerHTML == q) {
            for (let k = 0; k < 5; k++) {
                if (i < txt.length) {
                    if (txt.charAt(i) == "\\") {
                        answer.innerHTML += "\n";
                        i += 1;
                    } else {
                        answer.innerHTML += txt.charAt(i);
                    }
                    i++;
                }
            }
            hljs.highlightAll();
            timeoutIds.push(setTimeout(typeWriter, 1, txt, i, q, num));
        }
    }

</script>

</html>